!function(a,b){"use strict";b.Plugin.StateTransition=function(a,c){b.Plugin.call(this,a,c),this.settings={duration:.3*b.Timer.SECOND,ease:b.Easing.Exponential.InOut,properties:{alpha:0}},this._originalStateMethods={}},b.Plugin.StateTransition.prototype=Object.create(b.Plugin.prototype),b.Plugin.StateTransition.prototype.constructor=b.Plugin.StateTransition,b.Plugin.StateTransition.prototype.configure=function(a){var b;if(!a)return Object.create(this.settings);for(b in a)this.settings[b]&&(this.settings[b]=a[b])},b.Plugin.StateTransition.prototype.to=function(){var a,c,d=arguments[0],e=this;if(!d)throw"No state passed.";this._destroy(),game.paused=!0,this._texture=new b.RenderTexture(game,game.width,game.height,"cover"),this._texture.renderXY(game.world,-game.camera.x,-game.camera.y),this._originalStateMethods[d]=this._originalStateMethods[d]||{init:game.state.states[d].init,create:game.state.states[d].create},a=this._originalStateMethods[d].init,c=this._originalStateMethods[d].create,game.state.states[d].init=function(){game.add.existing(e._newCover()),a&&a.apply(this,arguments)},game.state.states[d].create=function(){c&&c.apply(this,arguments),e.bringToTop(),e._animateCover()},game.paused=!1,game.state.start.apply(game.state,arguments)},b.Plugin.StateTransition.prototype._newCover=function(){return this._cover=new b.Sprite(game,game.world.centerX,game.world.centerY,this._texture),this._cover.anchor.setTo(.5),this._cover},b.Plugin.StateTransition.prototype.bringToTop=function(){this._cover&&this._cover.bringToTop()},b.Plugin.StateTransition.prototype._animateCover=function(){var a,b,c;for(b in this.settings.properties)"object"==typeof this.settings.properties[b]?c=game.add.tween(this._cover[b]).to(this.settings.properties[b],this.settings.duration,this.settings.ease,!0):(a={},a[b]=this.settings.properties[b],c=game.add.tween(this._cover).to(a,this.settings.duration,this.settings.ease,!0));c.onComplete.addOnce(this._destroy,this)},b.Plugin.StateTransition.prototype._destroy=function(){this._cover&&this._cover.destroy(),this._texture&&this._texture.destroy()}}(window,Phaser);
